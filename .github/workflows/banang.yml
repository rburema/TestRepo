---
name: banang

on:

  workflow_dispatch:
    inputs:
        blah_blah_blah:
            description: ":banana: :apple: :rocket:"
            type: boolean
            default: true
            required: true

  push:
    paths:
      - '**.txt'
      - '**.yml'
      - '.github/workflows/banang.yml'
    branches:
      - brain
    tags:
      - '![1-9].[0-9]+*'

  pull_request:
    paths:
      - '**.txt'
      - '**.yml'
      - '.github/workflows/banang.yml'
    branches:
      - brain
    tags:
      - '![1-9].[0-9]+*'

jobs:
  my_aardbei:
    uses: ./.github/workflows/aardbei.yml
    
  mainjob:
    runs-on: ${{ matrix.os }}
    
    needs: [ my_aardbei ]
    
    strategy:
      fail-fast: false
      matrix:
        os: [windows-2022]
        zed: [x, y]
        exclude:
            - zed: ${{ inputs.blah_blah_blah && 'x' || '' }}
            - zed: ${{ inputs.blah_blah_blah && '' || 'y' }}

    steps:
        - name: Checkout
          uses: actions/checkout@v3

        - name: What's That OS String?
          run: |
            echo "_FOR_MAC=${{matrix.os == 'macos_11' && 'macncheeze_$(uuidgen)'}}" >> $GITHUB_ENV
            echo "_FOR_WIN=${{matrix.os == 'windows_2022' && 'WINBDOWS_$(uuidgen)'}}" >> $GITHUB_ENV
            echo "_FOR_LIN_OLD=${{matrix.os == 'ubuntu_20.04' && '2yearsisoldnow'}}" >> $GITHUB_ENV
            echo "_FOR_LIN_NEW=${{matrix.os == 'ubuntu_22.04' && 'bleedingedge'}}" >> $GITHUB_ENV
            echo "OS_NAME=${{ $_FOR_MAC || $_FOR_WIN || $_FOR_LIN_OLD || $_FOR_LIN_NEW || 'os_name_missing_$(uuidgen)' }}" >> $GITHUB_ENV

        - name: Do Thing Also
          run: |
            echo 'PROGRESS GOES BONK: $RANDOM | ${{ needs.my_aardbei.outputs.thething }} | $OS_NAME | ${{ inputs.blah_blah_blah }}'
