---
name: banang

on:

  workflow_dispatch:
    inputs:
        winblah:
            description: "WIN16"
            type: boolean
            default: true
            required: true
        ublah:
            description: "TUX"
            type: boolean
            default: false
            required: true

  push:
    paths:
      - '**.txt'
      - '**.yml'
      - '.github/workflows/banang.yml'
    branches:
      - brain
    tags:
      - '![1-9].[0-9]+*'

  pull_request:
    paths:
      - '**.txt'
      - '**.yml'
      - '.github/workflows/banang.yml'
    branches:
      - brain
    tags:
      - '![1-9].[0-9]+*'

env:
    OS_NAME: 'unkown-os'

jobs:
  my_aardbei:
    uses: ./.github/workflows/aardbei.yml
    
  mainjob:
    runs-on: ${{ matrix.os }}
    
    needs: [ my_aardbei ]
    
    strategy:
      fail-fast: false
      matrix:
        os: [windows-2022, ubuntu-22.04]
        zed: [x, y]
        exclude:
            - os: windows-2022
              if: ${{ ! inputs.winblah }}
            - os: ubunbtu-22.04
              if: ${{ ! inputs.ublah }}

    steps:
        - name: Checkout
          uses: actions/checkout@v3

        - name: What's That OS String?
          run: |
            echo "OS_NAME=${{ (matrix.os == 'ubuntu-22.04' && 'LNIUX') || (matrix.os == 'windows-2022' && 'WINBDOWS') || (matrix.os == 'blaaaah' && 'bloeh') || matrix.os }}" >> $GITHUB_ENV

        - name: Do Thing Also
          run: |
            echo 'PROGRESS GOES BONK: $RANDOM | ${{ needs.my_aardbei.outputs.thething }} | ${{ env.OS_NAME }} | ${{ inputs.blah_blah_blah }}'
